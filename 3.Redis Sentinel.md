# Redis Sentinel â€” High Availability

## How Redis offers High Availability and Automatic Failover ?

**Redis Sentinel**
Redis sentinel is the high availability solution offered by Redis. In case of a failure in your Redis cluster, Sentinel will automatically detects the point of failure and bring the cluster back to stable mode without any human intervention.

### What really happens inside Redis Sentinel ?

>Sentinel always checks the MASTER and SLAVE instances in the Redis cluster, checking whether they working as expected. If sentinel detects a failure in the MASTER node in a given cluster, Sentinel will start a failover process. As a result, Sentinel will pick a SLAVE instance and promote it to MASTER. Ultimately, the other remaining SLAVE instances will be automatically reconfigured to use the new MASTER instance.

ðŸ‘‰ *Furthermore, Sentinel is a robust distributed system, where multiple sentinels need to agree to about the fact a given master is no longer available. Then only the failover process starts a select a new MASTER node. This sentinel agreement is done according to the quorum value.*

- Default port for Redis server is 6379 and Sentinel is 26379. Hence make sure you open up these port using,
                    ```
                    sudo ufw allow 6379
                    sudo ufw allow 26379
                    ```
- in the redis directory you should be able to see both redis.conf and sentinel.conf configuration files, all the configuration related changes to setup are done here.


![image](https://user-images.githubusercontent.com/33947539/149473914-9fdc0303-8773-41da-aeec-56f5b46e4825.png)

![image](https://user-images.githubusercontent.com/33947539/149472172-643003cd-d77b-4f50-8e61-849c14aaa13a.png)

## Redis Cluster vs. Sentinel

- Redis Cluster is primarily a means of sharding data across multiple instances automatically.

**Redis Sentinel**:
*Redis supports multiple slaves replicating data from a master node. This provides a backup node which has your data on it, ready to serve data. However, in order to provide automated failover you need some tool. For Redis this tool is called Sentinel.*

#### What it Does

Sentinel is configured to point to a master you need managed. It will then query the master for all connected slaves. Once it has determined the configuration of the pod it will proceed to monitor each node and upon confirmation of a down master it will promote a slave and reconfigure each slave to point to the new master.

In order to use this for transparent client connection management you will need to either put the master node behind a Virtual IP or a load balancer which knows, or can be dynamically configured, which node is the master.

The other option is to use a client which has implemented Sentinel support.

Sentinel uses a **voting+quorum mechanism** so you need at least three Sentinel nodes working together. I refer to this as a Sentinel constellation. Each pod is given a name in the Constellation. This provides an additional capability if using Sentinel-capable client code. 

ðŸ‘‰ [What is quorum](https://github.com/MeSabya/SystemDesignDiscussion/blob/main/9.Quorum.md)

#### Reference: 
1. https://medium.com/@amila922/redis-sentinel-high-availability-everything-you-need-to-know-from-dev-to-prod-complete-guide-deb198e70ea6


